####################################################################
# GLOBAL VARIABLES

variable T equal 300.0
variable TH equal 1000.0
variable eqout equal 100000
variable pout equal 100000
variable nout equal 100000
variable dt equal 0.002
variable tdamp equal 1.249

####################################################################
# INITIALIZATION

units nano
dimension 3
boundary p p p 
box tilt large

#####################################################################
# INTERACTION POTENTIAL

atom_style molecular
atom_modify map array 

read_data 62mt_350fil_rerelax.data  extra/bond/per/atom 10 extra/angle/per/atom 10 extra/dihedral/per/atom 10 extra/special/per/atom 25 

molecule mol1 premolecule.data
molecule mol2 post-molecule.data
molecule mol3 premolecule-fil.data
molecule mol4 post-molecule-fil.data

pair_style lj/cut 6.735 
pair_modify shift yes
pair_coeff 1 1 4.14195 6.0 6.735
pair_coeff 1 2 4.14195 5.2 5.837
pair_coeff 1 3 4.14195 6.0 40
pair_coeff 1 4 4.14195 6.0 40
pair_coeff 2 2 4.14195 5.2 5.837
pair_coeff 2 3 4.14195 5.2 40
pair_coeff 2 4 4.14195 5.2 40
pair_coeff 3 3 4.14195 5.2 40
pair_coeff 3 4 4.14195 5.2 40
pair_coeff 4 4 4.14195 5.2 40

bond_style harmonic   
bond_coeff 1 2839 6.0      
bond_coeff 2 3150 4.0
bond_coeff 3 13700 5.2
bond_coeff 4 2839 4.0 
bond_coeff 5 2839 4.0 
bond_coeff 6 2839 4.0
bond_coeff 7 2839 4.0 

angle_style harmonic
angle_coeff 1 4140 180.0
angle_coeff 2 2000 180.0
angle_coeff 3 40 80.0
angle_coeff 4 40 100.0

dihedral_style harmonic
dihedral_coeff 1 40.5 1 1

special_bonds lj  0.0  0.0  1.0

neighbor 3.0 bin
neigh_modify delay 0 every 1 check yes

comm_modify cutoff 60 vel yes

comm_style tiled
fix fixbalance all balance 1000000 1.2 rcb 

#####################################################################
# SET EQUILIBRATION OUTPUT

variable Step equal "step"
variable Temp equal "temp"
variable EK equal "ke"
variable EP equal "pe"
variable Etot equal "etotal"
variable Epair equal "epair"
variable Ebond equal "ebond"
variable Eangle equal "eangle"
variable Edihedral equal "edihed" 
variable Vol equal  "vol" 
variable Pxx equal "pxx"
variable Pyy equal "pyy"
variable Pzz equal "pzz"
variable Density equal "density"
variable Press equal "press"
variable Lx equal "lx"
variable Ly equal "ly"
variable Lz equal "lz"

#####################################################################
# Minimize the system's energy

min_style cg
minimize 1.0e-16 1.0e-16 100000 100000
reset_timestep 0

##########################################################################

group lower id 	229	363	728	968	1301	1480	1683	2992	3069	3298	3364	3695	4370	4812	5105	5410	5891	6786	6928	7375	7702	7995	8676	8757	8911	9303	9747	9938	10178	10623	10786	10793	10794	11341	11579	12264	12354	12781	13191	13317	13642	13923	14066	14269	14635	15090	15466	15634	15890	16566	17109	17358	18031	18269	18391	18478	18761	19331	19462	19784	19999	20587	20844	20926	21239	21717	21776	22093	22289	23035	23121	23457	23968	24161	24321	25309	25525	25659	26022	26196	26366	26422	26638	26933	27147	27612	28771	29090	29349	29821	30022	30258	30574	31178	31390	31515	31716	31835	32409	32907	33350	33477	33615	33806	33918	34500	34804	35489	35567	36035	36406	36594	36595	36902	37265	37397	37901	38290	38518	38962	39106	39405	39970	40141	40214	40383	40768	42347	43047	43123	43286	43597	43741	43936	44048	44447	44604	44829	45196	45711	46152	46642	46743	46857	47311	47551	48279	48435	48584	49294	49586	50064	50437	51356	51582	51722	52028	52060	52402   55589	55814	56039	56265	56490	56715	56939	57164	57388	57612	57836	58061	58286	58437	58663	58889	59114	59340	59564	59788	60012	60235	60236	60459	60683	60908	61133	64356	64581	64803	64804	64805	65024	65025	65026	65027	65243	65244	65245	65246	65247	65248	65463	65464	65465	65466	65467	65685	65686	65687	65909	66135	66136	66137	66363	66364	66365	66366	66367	66593	66594	66595	66596	66822	66823	66824	66825	67051	67052	75966	75967	75968	75969	76195	76196	76197	76198	76424	76425	76650	76871	76872	76873	76874	77092	77093	77094	77095	77313	77314	77315	77316	77534	77535	77536	77537	77757	77758	77977	77981	78207	78433	78434	78660	78661	78662	78866	79090	79316	79541	79767	79993	80219	80444	80668	80892	81116	81339	81340	81563	82875	83099	83323	83547	83772	83997	84222	84448	84674	102246	102472	102473	102699	102700	102701	102927	102928	102929	103155	103381	103604	103605	103825	103826	103827	103828	104047	104048	104049	104270	104271	104493	104494	104717	104942	105341	105342	105343	105569	105570	105571	105572	105573	105799	105800	105801	105802	105803	106029	106030	106031	106032	106258	106259	106481	106482	106483	106702	106703	106704	106705	106921	106922	106923	106924	106925	106926	107141	107142	107143	107144	107145	107363	107364	107365	107586	107587	107810	108036	108037	111194	111419	111644	111869	112094	112319	112544	112769	112994	113218	113442	113667	113891	113963	114187	114411	114635	114860	115085	115310	115535	115761	115986	116211	116436	116661	122860	123085	123309	123534	123759	123983	124208	124433	124658	124883	125108	125333	125557	134622	134847	135073	135298	135523	135748	135972	136197	136421	136645	136870	137094	137319	140259	140485	140710	140935	141160	141384	141609	141834	142058	142282	142507	142732	142957	146115	146116	146342	146568	146792	147014	147015	147016	147237	147238	147459	147460	147461	147683	147907	148131	148357	148583	148584	148810	148811	152163	152388	152613	152838	153063	153064	153289	153513	153738	153962	154186	154411	154635	154860	154940	154941	154942	154943	154944	155161	155162	155163	155164	155384	155385	155386	155387	155608	155611	155612	155834	155835	155836	155837	156063	156064	156065	156066	156292	156293	156294	156295	156521	156522	156523	156749	156975	157199	157421	157422	157423	157642	157643	157644	157645	157851	158075	158297	158298	158299	158520	158521	158743	158744	158967	159192	159418	159644	159645	159871	159872	160098	160324	160549	160825	161051	161276	161502	161727	161952	162177	162401	162625	162849	163073	163297	163522	166587	166588	166589	166809	166810	166811	167032	167033	167256	167480	167705	167931	167932	168158	168159	168160	168386	168387	168613	168614	168615	168841	169065	169066	169287	169288	169289	172584	172808	173032	173257	173482	173707	173932	174158	174383	174609	174834	175058	175282	175571	175572	175795	176021	176247	176248	176474	176475	178049	178050	178270	178271	178272	178273	180075	180299	180524	180748	180973	181198	181296	181519	181520	181742	181743	181966	182190	182414	182638	182864	183090	183316	183542	183768	183993	187051	187052	187053	187054	187055	187056	187057	187058	187284	187285	187286	187287	187288	187289	187290	187291	187292	187293	187294	187295	187296	187522	187523	187524	187525	187526	187527	187528	187529	187530	187756	187757	187758	187984	187998	187999	188207	188208	188423	188424	188425	188426	188427	188428	188429	188430	188431	188636	188637	188638	188639	188640	188641	188642	188643	188644	188645	188646	188647	188851	188852	188853	188854	188855	188856	188857	188858	188859	188860	193071	193297	193522	193748	193973	194198	194422	194645	194646	194869	195093	195317	195542	195767	204708	204709	204930	204931	204932	205153	205154	205376	205377	205601	205827	205828	206054	206055	206281	206282	206508	206734	206959	207184	207407	207408	207593	207818	208043	208269	208494	208720	208946	209171	209395	209619	209843	210067	210291	211575	211800	212025	212250	212475	212700	212925	213150	213374	213502	213726	213951	214176	214400	214625	214850	215075	215300	215525	215749	215974	216199	228146	228371	228597	228823	229049	229275	229500	229725	229948	229949	230171	230172	230395	230619	230843	231110	231111	231112	231338	231339	231340	231566	231567	231568	231794	232017	232018	232238	232239	232240	232241	232460	232461	232462	232681	232682	232683	232684	232904	232905	233128	233352	233578	233804	233805	233806

group upper id 	230	362	727	967	1302	1479	1684	2991	3070	3297	3363	3696	3697	4369	4811	5106	5411	5892	6785	6929	7374	7701	7996	8675	8756	8912	9304	9748	9939	10179	10624	10785	11340	11578	12265	12355	12780	13190	13318	13641	13922	14067	14270	14634	15091	15467	15633	15889	16565	17110	17359	18032	18268	18392	18479	18760	19330	19463	19785	19998	20588	20845	20925	21240	21716	21775	22092	22290	23036	23120	23458	23969	24160	24322	25308	25524	25660	26021	26195	26365	26421	26637	26932	27146	27613	28770	29089	29350	29351	29352	29822	30021	30259	30573	31177	31391	31514	31715	31836	32410	32908	33351	33478	33614	33805	33919	34499	34803	35488	35568	36034	36405	36593	36901	37264	37398	37902	38291	38519	38961	39105	39404	39971	40140	40213	40382	40769	42346	43046	43122	43285	43596	43740	43937	44047	44448	44605	44830	45197	45710	46151	46641	46742	46858	47310	47552	48278	48436	48585	49293	49585	50065	50438	51355	51581	51721	52027	52061	52403   55588	55813	56038	56264	56489	56714	56938	57163	57387	57611	57835	58060	58285	58436	58662	58888	59113	59339	59563	59787	60010	60011	60234	60458	60682	60907	61132	64354	64355	64578	64579	64580	64799	64800	64801	64802	65018	65019	65020	65021	65022	65023	65238	65239	65240	65241	65242	65460	65461	65462	65684	65908	66134	66360	66361	66362	66588	66589	66590	66591	66592	66818	66819	66820	66821	67047	67048	67049	67050	75970	75971	75972	75973	76199	76200	76426	76651	76875	77096	77097	77098	77099	77317	77318	77319	77320	77538	77539	77540	77541	77759	77760	77761	77762	77982	77983	78208	78209	78435	78436	78437	78663	78664	78665	78666	78867	79091	79317	79542	79768	79994	80220	80445	80669	80893	81117	81341	81564	81565	83100	83324	83548	83773	83998	84223	84449	84675	102247	102248	102474	102475	102476	102702	102703	102704	102930	103156	103159	103382	103384	103385	103606	103608	103609	103829	103830	104050	104051	104052	104053	104272	104273	104274	104495	104496	104718	104719	104943	105344	105345	105346	105347	105348	105574	105575	105576	105577	105578	105804	105805	105806	105807	106033	106034	106260	106484	106706	106707	106708	106927	106928	106929	106930	107146	107147	107148	107149	107150	107151	107366	107367	107368	107369	107370	107588	107589	107590	107811	107812	108038	108039	108040	111195	111420	111645	111870	112095	112320	112545	112770	112995	113219	113443	113668	113892	113964	114188	114412	114636	114861	115086	115311	115536	115762	115987	116212	116437	116662	122859	123084	123308	123533	123758	123982	124207	124432	124657	124882	125107	125332	125556	134623	134848	135074	135299	135524	135749	135973	136198	136422	136646	136871	137095	137320	140260	140486	140711	140936	141161	141385	141610	141835	142059	142283	142508	142733	142958	146117	146343	146569	146793	147017	147239	147240	147241	147462	147463	147684	147685	147686	147908	148132	148358	148359	148585	148586	148812	148813	152164	152389	152614	152615	152839	153065	153290	153514	153739	153963	154187	154412	154636	154861	154936	154937	154938	154939	155159	155160	155383	155607	155833	156059	156060	156061	156062	156286	156288	156289	156290	156291	156517	156518	156519	156520	156746	156747	156748	156974	157196	157197	157198	157417	157418	157419	157420	157637	157638	157639	157640	157641	157850	158072	158073	158074	158295	158296	158518	158519	158742	158966	159191	159417	159643	159869	159870	160096	160097	160323	160548	160824	161050	161275	161501	161726	161951	162176	162400	162624	162848	163072	163296	163521	166590	166591	166592	166812	166813	166814	167034	167035	167036	167257	167258	167481	167706	167707	167933	167934	167935	168161	168162	168388	168389	168390	168616	168842	169067	169290	169291	172583	172807	173031	173256	173481	173706	173931	174157	174382	174608	174833	175057	175281	175573	175574	175575	175796	175797	176022	176023	176249	176250	178274	178275	179850	180074	180298	180523	180747	180972	181197	181297	181521	181744	181745	181967	181968	182191	182415	182639	182865	183091	183317	183543	183769	183994	187276	187277	187278	187279	187280	187281	187282	187283	187509	187510	187511	187512	187513	187514	187515	187516	187517	187518	187519	187520	187521	187747	187748	187749	187750	187751	187752	187753	187754	187755	187981	187982	187983	188198	188199	188200	188201	188202	188203	188204	188205	188206	188411	188412	188413	188414	188415	188416	188417	188418	188419	188420	188421	188422	188626	188627	188628	188629	188630	188631	188632	188633	188634	188635	193070	193296	193521	193747	193972	194197	194420	194421	194644	194868	195092	195316	195541	195766	204705	204706	204707	204928	204929	205151	205152	205375	205600	205826	206052	206053	206279	206280	206506	206507	206733	206958	207182	207183	207405	207406	207594	207819	208044	208270	208495	208721	208947	209172	209396	209620	209844	210068	210292	211350	211574	211799	212024	212249	212474	212699	212924	213149	213373	213503	213727	213952	214177	214401	214626	214851	215076	215301	215526	215750	215975	216200	228147	228372	228598	228824	229050	229276	229501	229726	229950	230173	230174	230396	230397	230620	230844	231113	231114	231115	231341	231342	231343	231569	231795	232019	232242	232243	232463	232464	232465	232466	232685	232686	232687	232906	232907	232908	232909	233129	233130	233353	233579	233580	233581	233807	233808	233809

group react_point id  233852	233854	233856	233858	233860	233862	233864	233866	233868	233870	233872	233874	233876	233878	233880	233882	233884	233886	233888	233890	233892	233894	233896	233898	233900	233902	233904	233906	233908	233910	233912	233914	233916	233918	233920	233922	233924	233926	233928	233930	233932	233934	233936	233938	233940	233942	233944	233946	233948	233950	233952	233954	233956	233958	233960	233962	233964	233966	233968	233970	233972	233974	233976	233978	233980	233982	233984	233986	233988	233990	233992	233994	233996	233998	234000	234002	234004	234006	234008	234010	234012	234014	234016	234018	234020	234022	234024	234026	234028	234030	234032	234034	234036	234038	234040	234042	234044	234046	234048	234050	234052	234054	234056	234058	234060	234062	234064	234066	234068	234070	234072	234074	234076	234078	234080	234082	234084	234086	234088	234090	234092	234094	234096	234098	234100	234102	234104	234106	234108	234110	234112	234114	234116	234118	234120	234122	234124	234126	234128	234130	234132	234134	234136	234138	234140	234142	234144	234146	234148	234150	234152	234154	234156	234158	234160	234162	234164	234166	234168	234170	234172	234174	234176	234178	234180	234182	234184	234186	234188	234190	234192	234194	234196	234198	234200	234202	234204	234206	234208	234210	234212	234214	234216	234218	234220	234222	234224	234226	234228	234230	234232	234234	234236	234238	234240	234242	234244	234246	234248	234250	234252	234254	234256	234258	234260	234262	234264	234266	234268	234270	234272	234274	234276	234278	234280	234282	234284	234286	234288	234290	234292	234294	234296	234298	234300	234302	234304	234306	234308	234310	234312	234314	234316	234318	234320	234322	234324	234326	234328	234330	234332	234334	234336	234338	234340	234342	234344	234346	234348	234350	234352	234354	234356	234358	234360	234362	234364	234366	234368	234370	234372	234374	234376	234378	234380	234382	234384	234386	234388	234390	234392	234394	234396	234398	234400	234402	234404	234406	234408	234410	234412	234414	234416	234418	234420	234422	234424	234426	234428	234430	234432	234434	234436	234438	234440	234442	234444	234446	234448	234450	234452	234454	234456	234458	234460	234462	234464	234466	234468	234470	234472	234474	234476	234478	234480	234482	234484	234486	234488	234490	234492	234494	234496	234498	234500	234502	234504	234506	234508	234510	234512	234514	234516	234518	234520	234522	234524	234526	234528	234530	234532	234534	234536	234538	234540	234542	234544	234546	234548	234550	234552	234554	234556	234558	234560	234562	234564	234566	234568	234570	234572	234574	234576	234578	234580	234582	234584	234586	234588	234590	234592	234594	234596	234598	234600	234602	234604	234606	234608	234610	234612	234614	234616	234618	234620	234622	234624	234626	234628	234630	234632	234634	234636	234638	234640	234642	234644	234646	234648	234650	234652	234654	234656	234658	234660	234662	234664	234666	234668	234670	234672	234674	234676	234678	234680	234682	234684	234686	234688	234690	234692	234694	234696	234698	234700	234702	234704	234706	234708	234710	234712	234714	234716	234718	234720	234722	234724	234726	234728	234730	234732	234734	234736	234738	234740	234742	234744	234746	234748	234750	234752	234754	234756	234758	234760	234762	234764	234766	234768	234770	234772	234774	234776	234778	234780	234782	234784	234786	234788	234790	234792	234794	234796	234798	234800	234802	234804	234806	234808	234810	234812	234814	234816	234818	234820	234822	234824	234826	234828	234830	234832	234834	234836	234838	234840	234842	234844	234846	234848	234850	234852	234854	234856	234858	234860	234862	234864	234866	234868	234870	234872	234874	234876	234878	234880	234882	234884	234886	234888	234890	234892	234894	234896	234898	234900	234902	234904	234906	234908	234910	234912	234914	234916	234918	234920	234922	234924	234926	234928	234930	234932	234934	234936	234938	234940	234942	234944	234946	234948	234950	234952	234954	234956	234958	234960	234962	234964	234966	234968	234970	234972	234974	234976	234978	234980	234982	234984	234986	234988	234990	234992	234994	234996	234998	235000	235002	235004	235006	235008	235010	235012	235014	235016	235018	235020	235022	235024	235026	235028	235030	235032	235034	235036	235038	235040	235042	235044	235046	235048	235050	235052	235054	235056	235058	235060	235062	235064	235066	235068	235070	235072	235074	235076	235078	235080	235082	235084	235086	235088	235090	235092	235094	235096	235098	235100	235102	235104	235106	235108	235110	235112	235114	235116	235118	235120	235122	235124	235126	235128	235130	235132	235134	235136	235138	235140	235142	235144	235146	235148	235150	235152	235154	235156	235158	235160	235162	235164	235166	235168	235170	235172	235174	235176	235178	235180	235182	235184	235186	235188	235190	235192	235194	235196	235198	235200	235202	235204	235206	235208	235210	235212	235214	235216	235218	235220	235222	235224	235226	235228	235230	235232	235234	235236	235238	235240	235242	235244	235246	235248	235250	235252	235254	235256	235258	235260	235262	235264	235266	235268	235270	235272	235274	235276	235278	235280	235282	235284	235286	235288	235290	235292	235294	235296	235298	235300	235302	235304	235306	235308	235310	235312	235314	235316	235318	235320	235322	235324	235326	235328	235330	235332	235334	235336	235338	235340	235342	235344	235346	235348	235350	235352	235354	235356	235358	235360	235362	235364	235366	235368	235370	235372	235374	235376	235378	235380	235382	235384	235386	235388	235390	235392	235394	235396	235398	235400	235402	235404	235406	235408	235410	235412	235414	235416	235418	235420	235422	235424	235426	235428	235430	235432	235434	235436	235438	235440	235442	235444	235446	235448	235450	235452	235454	235456	235458	235460	235462	235464	235466	235468	235470	235472	235474	235476	235478	235480	235482	235484	235486	235488	235490	235492	235494	235496	235498	235500	235502	235504	235506	235508	235510	235512	235514	235516	235518	235520	235522	235524	235526	235528	235530	235532	235534	235536	235538	235540	235542	235544	235546	235548	235550	235552	235554	235556	235558	235560	235562	235564	235566	235568	235570	235572	235574	235576	235578	235580	235582	235584	235586	235588	235590	235592	235594	235596	235598	235600	235602	235604	235606	235608	235610	235612	235614	235616	235618	235620	235622	235624	235626	235628	235630	235632	235634	235636	235638	235640	235642	235644	235646	235648	235650	235652	235654	235656	235658	235660	235662	235664	235666	235668	235670	235672	235674	235676	235678	235680	235682	235684	235686	235688	235690	235692	235694	235696	235698	235700	235702	235704	235706	235708	235710	235712	235714	235716	235718	235720	235722	235724	235726	235728	235730	235732	235734	235736	235738	235740	235742	235744	235746	235748	235750	235752	235754	235756	235758	235760	235762	235764	235766	235768	235770	235772	235774	235776	235778	235780	235782	235784	235786	235788	235790	235792	235794	235796	235798	235800	235802	235804	235806	235808	235810	235812	235814	235816	235818	235820	235822	235824	235826	235828	235830	235832	235834	235836	235838	235840	235842	235844	235846	235848	235850	235852	235854	235856	235858	235860	235862	235864	235866	235868	235870	235872	235874	235876	235878	235880	235882	235884	235886	235888	235890	235892	235894	235896	235898	235900	235902	235904	235906	235908	235910	235912	235914	235916	235918	235920	235922	235924	235926	235928	235930	235932	235934	235936	235938	235940	235942	235944	235946	235948	235950   235952	235953	235956	235957	235960	235961	235964	235965	235968	235969	235972	235973	235976	235977	235980	235981	235984	235985	235988	235989	235992	235993	235996	235997	236000	236001	236004	236005	236008	236009	236012	236013	236016	236017	236020	236021	236024	236025	236028	236029	236032	236033	236036	236037	236040	236041	236044	236045	236048	236049	236052	236053	236056	236057	236060	236061	236064	236065	236068	236069	236072	236073	236076	236077	236080	236081	236084	236085	236088	236089	236092	236093	236096	236097	236100	236101	236104	236105	236108	236109	236112	236113	236116	236117	236120	236121	236124	236125	236128	236129	236132	236133	236136	236137	236140	236141	236144	236145	236148	236149	236152	236153	236156	236157	236160	236161	236164	236165	236168	236169	236172	236173	236176	236177	236180	236181	236184	236185	236188	236189	236192	236193	236196	236197	236200	236201	236204	236205	236208	236209	236212	236213	236216	236217	236220	236221	236224	236225	236228	236229	236232	236233	236236	236237	236240	236241	236244	236245	236248	236249	236252	236253	236256	236257	236260	236261	236264	236265	236268	236269	236272	236273	236276	236277	236280	236281	236284	236285	236288	236289	236292	236293	236296	236297	236300	236301	236304	236305	236308	236309	236312	236313	236316	236317	236320	236321	236324	236325	236328	236329	236332	236333	236336	236337	236340	236341	236344	236345	236348	236349	236352	236353	236356	236358	236360	236362	236364	236366	236368	236370	236372	236374	236376	236378	236380	236382	236384	236386	236388	236390	236392	236394	236396	236398	236400	236402	236404	236406	236408	236410	236412	236414	236416	236418	236420	236422	236424	236426	236428	236430	236432	236434	236436	236438	236440	236442	236444	236446	236448	236450	236452	236454	236456	236458	236460	236462	236464	236466	236468	236470	236472	236474	236476	236478	236480	236482	236484	236486	236488	236490	236492	236494	236496	236498	236500	236502	236504	236506	236508	236510	236512	236514	236516	236518	236520	236522	236524	236526	236528	236530	236532	236534	236536	236538	236540	236542	236544	236546	236548	236550	236552	236554	236556	236558	236560	236562	236564	236566	236568	236570	236572	236574	236576	236578	236580	236582	236584	236586	236588	236590	236592	236594	236596	236598	236600	236602	236604	236606	236608	236610	236612	236614	236616	236618	236620	236622	236624	236626	236628	236630	236632	236634	236636	236638	236640	236642	236644	236646	236648	236650	236652	236654	236656	236658	236660	236662	236664	236666	236668	236670	236672	236674	236676	236678	236680	236682	236684	236686	236688	236690	236692	236694	236696	236698	236700	236702	236704	236706	236708	236710	236712	236714	236716	236718	236720	236722	236724	236726	236728	236730	236732	236734	236736	236738	236740	236742	236744	236746	236748	236750	236752	236754	236756	236758	236760	236762	236764	236766	236768	236770	236772	236774	236776	236778	236780	236782	236784	236786	236788	236790	236792	236794	236796	236798	236800	236802	236804	236806	236808	236810	236812	236814	236816	236818	236820	236822	236824	236826	236828	236830	236832	236834	236836	236838	236840	236842	236844	236846	236848	236850	236852	236854	236856	236858	236860	236862	236864	236866	236868	236870	236872	236874	236876	236878	236880	236882	236884	236886	236888	236890	236892	236894	236896	236898	236900	236902	236904	236906	236908	236910	236912	236914	236916	236918	236920	236922	236924	236926	236928	236930	236932	236934	236936	236938	236940	236942	236944	236946	236948	236950	236952	236954	236956	236958	236960	236962	236964	236966	236968	236970	236972	236974	236976	236978	236980	236982	236984	236986	236988	236990	236992	236994	236996	236998	237000	237002	237004	237006	237008	237010	237012	237014	237016	237018	237020	237022	237024	237026	237028	237030	237032	237034	237036	237038	237040	237042	237044	237046	237048	237050	237052	237054	237056	237058	237060	237062	237064	237066	237068	237070	237072	237074	237076	237078	237080	237082	237084	237086	237088	237090	237092	237094	237096	237098	237100	237102	237104	237106	237108	237110	237112	237114	237116	237118	237120	237122	237124	237126	237128	237130	237132	237134	237136	237138	237140	237142	237144	237146	237148	237150	237152	237154	237156	237158	237160	237162	237164	237166	237168	237170	237172	237174	237176	237178	237180	237182	237184	237186	237188	237190	237192	237194	237196	237198	237200	237202	237204	237206	237208	237210	237212	237214	237216	237218	237220	237222	237224	237226	237228	237230	237232	237234	237236

group boundary union lower upper
group thermo_part subtract all boundary

########################################################################

velocity all create ${T} 135468 loop local units box

velocity boundary set 0.0 0.0 0.0 sum no
fix 1 upper nve/noforce
fix 2 thermo_part nve 
fix 3 thermo_part langevin ${T} ${T} ${tdamp} 125684 scale 1  1  scale 2  0.961649 scale 3  1 scale 4  0.961649 
fix 4 lower setforce 0.0 0.0 0.0

thermo 10000
thermo_style custom step temp ke pe etotal epair ebond eangle lx ly lz xy vol pxx pyy pzz density
timestep ${dt}
run 100000

reset_timestep 0

########################################################################

bond_style harmonic   
bond_coeff 1 2839 6.0      
bond_coeff 2 3150 4.0
bond_coeff 3 13700 5.2
bond_coeff 4 2.5 4.0 
bond_coeff 5 2.5 4.0
bond_coeff 6 2.5 4.0 
bond_coeff 7 2.5 4.0 

########################################################################
# REACTION EQUILIBRATION

compute 1 all property/local btype batom1 batom2
compute 2 all bond/local dist engpot force

compute 3 all property/local atype aatom1 aatom2 aatom3
compute 4 all angle/local  theta eng

dump bond_list_relax all local 1000000 BondList_relax.dump index c_1[1] c_1[2] c_1[3] c_2[1] c_2[2] c_2[3] 
dump angle_list_relax all local 1000000 AngleList_relax.dump index c_3[1] c_3[2] c_3[3] c_3[4] c_4[1] c_4[2]

velocity all create ${TH} 475869 loop local units box

fix 100 all bond/react reset_mol_ids yes & 
     react myrx01 react_point 100 1 40 mol1 mol2 automap.data prob 1.0 454894 &
     react myrx02 react_point 100 1 20 mol3 mol4 automap-fil.data prob 1.0 859403

#fix 100 all bond/react react myrx01 react_point 100 1 40 mol1 mol2 automap.data prob 1.0 859403
#fix 200 all bond/react react myrx02 react_point 100 1 20 mol3 mol4 automap-fil.data prob 1.0 859403

fix 111 all ave/time 10 100 1000 f_100[1] f_100[2] file React_relax.txt
# fix 111 all ave/time 10 100 1000 f_100[2] file React_fil_relax.txt

########################################################################

velocity all create ${TH} 475869 loop local units box
velocity boundary set 0.0 0.0 0.0 sum no
fix 1 upper nve/noforce
fix 2 thermo_part nve 
fix 3 thermo_part langevin ${TH} ${TH} ${tdamp} 125684 scale 1  1  scale 2  0.961649 scale 3  1 scale 4  0.961649 
fix 4 lower setforce 0.0 0.0 0.0
thermo 10000
thermo_style custom step temp ke pe etotal epair ebond eangle lx ly lz xy vol pxx pyy pzz density
timestep ${dt}
run 20000000

unfix 1
unfix 2
unfix 3
unfix 4
velocity all set 0.0 0.0 0.0 sum no

############################################################################################
# Compute pe/atom

fix deformation_relax all print ${nout} "${Step} ${Temp} ${EK} ${EP} ${Etot} ${Epair} ${Ebond} ${Eangle} ${Edihedral} ${Press} ${Vol} ${Lx} ${Ly} ${Lz} ${Pxx} ${Pyy} ${Pzz} ${Density}" file deformation_relax.txt screen no

############################################################################

compute Peatom_relax all pe/atom
fix Peatom_relax all ave/atom 100 1000 ${nout} c_Peatom_relax
dump Peatom_relax all custom ${pout} Peatom_relax.lammpstrj id type x y z f_Peatom_relax
dump_modify Peatom_relax first yes

# Compute energy

compute Temp all temp
compute E_k all ke
compute E_pe all pe bond angle
compute E_pair all pair lj/cut epair

compute ebond all bond/local engpot
compute eangle all angle/local eng

compute Ebond all reduce sum c_ebond
compute Eangle all reduce sum c_eangle 

#####################################################################
# Equilibrition

velocity all create ${T} 135468 loop local units box

velocity boundary set 0.0 0.0 0.0 sum no
fix 1 upper nve/noforce
fix 2 thermo_part nve 
fix 3 thermo_part langevin ${T} ${T} ${tdamp} 125684 scale 1  1  scale 2  0.961649 scale 3  1 scale 4  0.961649 
fix 4 lower setforce 0.0 0.0 0.0
thermo 10000
thermo_style custom step temp ke pe etotal epair ebond eangle lx ly lz xy vol pxx pyy pzz density
timestep ${dt}
run 50000000

unfix 1
unfix 2
unfix 3
unfix 4
velocity all set 0.0 0.0 0.0 sum no
unfix deformation_relax
uncompute Peatom_relax
unfix Peatom_relax 
undump Peatom_relax 

uncompute Temp 
uncompute E_k 
uncompute E_pe 
uncompute E_pair 
uncompute ebond 
uncompute eangle 
uncompute Ebond
uncompute Eangle 

uncompute 1 
uncompute 2 
uncompute 3
uncompute 4
undump bond_list_relax
undump angle_list_relax

unfix 111

reset_timestep 0


############################################################################################
# Compute pe/atom

fix deformation all print ${nout} "${Step} ${Temp} ${EK} ${EP} ${Etot} ${Epair} ${Ebond} ${Eangle} ${Edihedral} ${Press} ${Vol} ${Lx} ${Ly} ${Lz} ${Pxx} ${Pyy} ${Pzz} ${Density}" file deformation_shear.txt screen no

# Compute pe/atom

compute Peatom all pe/atom
fix Peatom all ave/atom 100 1000 ${nout} c_Peatom
dump Peatom all custom ${pout} Peatom_shear.lammpstrj id type x y z f_Peatom
dump_modify Peatom first yes

# Compute energy

compute shear_Temp all temp
compute shear_E_k all ke
compute shear_E_pe all pe bond angle
compute shear_E_pair all pair lj/cut epair

compute shear_ebond all bond/local engpot
compute shear_eangle all angle/local eng

compute shear_Ebond all reduce sum c_shear_ebond
compute shear_Eangle all reduce sum c_shear_eangle 

# Compute bond energy

compute 11 all property/local btype batom1 batom2
compute 22 all bond/local dist engpot force

compute 33 all property/local atype aatom1 aatom2 aatom3
compute 44 all angle/local  theta eng

dump angle_list_shear all local 1000000 AngleList_shear.dump index c_33[1] c_33[2] c_33[3] c_33[4] c_44[1] c_44[2]

dump bond_list_shear all local 1000000 BondList_shear.dump index c_11[1] c_11[2] c_11[3] c_22[1] c_22[2] c_22[3] 

fix 222 all ave/time 10 100 1000 f_100[1] f_100[2] file React_shear.txt

############################################################################################
# Compute force

variable Fx equal -fcm(upper,x)
variable Fy equal -fcm(upper,y)

fix results all ave/time 100 1000 ${nout} c_shear_Temp c_shear_E_k c_shear_E_pe c_shear_E_pair c_shear_Ebond c_shear_Eangle v_Fx v_Fy file Results.txt 

#####################################################################
velocity all create ${T} 135468 loop local units box

velocity boundary set 0.0 0.0 0.0 sum no
fix 1 upper nve/noforce
fix 2 thermo_part nve 
fix 3 thermo_part langevin ${T} ${T} ${tdamp} 125684 scale 1  1  scale 2  0.961649 scale 3  1 scale 4  0.961649 
fix 4 lower setforce 0.0 0.0 0.0

thermo 10000
thermo_style custom step temp ke pe etotal epair ebond eangle lx ly lz xy vol pxx pyy pzz density
timestep ${dt}

############################################################################################
# LOADING
variable dmove equal 0.1
variable nloop equal 10000
# loading
label loading
variable i loop ${nloop}  
change_box all xy delta ${dmove} remap units box 
run 10000
next i
jump in.62mt_350fil_relax_and_shear loading 

write_data 62mt_350fil_relax_and_shear.relax pair ij
